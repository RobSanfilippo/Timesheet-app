<!DOCTYPE html>
<html>
<head>
    <title>Weekly Timesheet</title>
    <style>
        table { border-collapse: collapse; margin-bottom: 30px; width: auto; }
        th, td { border: 1px solid black; padding: 10px; text-align: center; white-space: nowrap; }
        select, input { width: auto; min-width: 80px; }
        td:nth-child(6) { border-right: 4px solid black; }
    </style>
    <script>
        function calculateHours(tableId) {
            let totalNonHygiene = 0, totalHygieneHours = 0, totalHours = 0;
            for (let i = 1; i <= 6; i++) {
                let startTime = document.getElementById(`start${tableId}${i}`).value;
                let endTime = document.getElementById(`end${tableId}${i}`).value;
                let lunch = parseFloat(document.getElementById(`lunch${tableId}${i}`).value) || 0;
                let nonHygiene = parseFloat(document.getElementById(`nonHygiene${tableId}${i}`).value) || 0;
                
                if (startTime && endTime) {
                    let start = new Date(`01/01/2023 ${startTime}`);
                    let end = new Date(`01/01/2023 ${endTime}`);
                    let hygieneHours = (end - start) / (1000 * 60 * 60) - lunch - nonHygiene;
                    let totalDayHours = hygieneHours + nonHygiene;
                    
                    document.getElementById(`hygiene${tableId}${i}`).value = hygieneHours.toFixed(2);
                    document.getElementById(`total${tableId}${i}`).value = totalDayHours.toFixed(2);
                    
                    totalNonHygiene += nonHygiene;
                    totalHygieneHours += hygieneHours;
                    totalHours += totalDayHours;
                }
            }
            document.getElementById(`sumNonHygiene${tableId}`).value = totalNonHygiene.toFixed(2);
            document.getElementById(`sumHygiene${tableId}`).value = totalHygieneHours.toFixed(2);
            document.getElementById(`sumTotal${tableId}`).value = totalHours.toFixed(2);
            calculateSummary();
        }

        function calculateSummary() {
            let totalHygieneHours = 
                (parseFloat(document.getElementById("sumHygiene1").value) || 0) + 
                (parseFloat(document.getElementById("sumHygiene2").value) || 0);
            let totalHours = 
                (parseFloat(document.getElementById("sumTotal1").value) || 0) + 
                (parseFloat(document.getElementById("sumTotal2").value) || 0);
            
            document.getElementById("summaryHygiene").value = totalHygieneHours.toFixed(2);
            document.getElementById("summaryTotal").value = totalHours.toFixed(2);
        }

        function generateTimeOptions() {
            let times = [];
            let periods = ['AM', 'PM'];
            for (let h = 7; h <= 20; h++) {
                for (let m = 0; m < 60; m += 5) {
                    let hour = h;
                    let period = hour >= 12 ? 'PM' : 'AM';
                    let displayHour = hour > 12 ? hour - 12 : hour;
                    let minute = m.toString().padStart(2, '0');
                    times.push(`${displayHour}:${minute} ${period}`);
                }
            }
            return times;
        }
    </script>
</head>
<body>
    <h2>Weekly Timesheet</h2>
    <script>
        function createTable(tableId) {
            document.write(`<table>
                <tr>
                    <th>Day</th>
                    <th>Start Time</th>
                    <th>End Time</th>
                    <th>Lunch</th>
                    <th>Non-Hygiene (hrs)</th>
                    <th style="border-right: 4px solid black;">Hyg Total Hours</th>
                    <th>Total Hours</th>
                </tr>`);
            
            const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const timeOptions = generateTimeOptions();
            days.forEach((day, index) => {
                document.write(`<tr>
                    <td>${day}</td>
                    <td><select id="start${tableId}${index+1}" onchange="calculateHours('${tableId}')">` + timeOptions.map(t => `<option>${t}</option>`).join('') + `</select></td>
                    <td><select id="end${tableId}${index+1}" onchange="calculateHours('${tableId}')">` + timeOptions.map(t => `<option>${t}</option>`).join('') + `</select></td>
                    <td><input type="number" id="lunch${tableId}${index+1}" value="0" min="0" step="0.25" onchange="calculateHours('${tableId}')"></td>
                    <td><input type="number" id="nonHygiene${tableId}${index+1}" value="0" min="0" step="0.25" onchange="calculateHours('${tableId}')"></td>
                    <td style="border-right: 4px solid black;"><input type="text" id="hygiene${tableId}${index+1}" readonly></td>
                    <td><input type="text" id="total${tableId}${index+1}" readonly></td>
                </tr>`);
            });
            
            document.write(`<tr>
                <td><strong>Total</strong></td>
                <td colspan="2"></td>
                <td></td>
                <td><input type="text" id="sumNonHygiene${tableId}" readonly></td>
                <td style="border-right: 4px solid black;"><input type="text" id="sumHygiene${tableId}" readonly></td>
                <td><input type="text" id="sumTotal${tableId}" readonly></td>
            </tr>
            </table>`);
        }
        createTable("1");
        document.write(`<br><br>`);
        createTable("2");
        document.write(`<br><br>`);
        document.write(`<table>
            <tr>
                <th>Total Combined Hours</th>
                <th>Hyg Total Hours</th>
                <th>Total Hours</th>
            </tr>
            <tr>
                <td><strong>Summary</strong></td>
                <td><input type="text" id="summaryHygiene" readonly></td>
                <td><input type="text" id="summaryTotal" readonly></td>
            </tr>
        </table>`);
    </script>
</body>
</html>
